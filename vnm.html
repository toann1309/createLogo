<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="./style.css">
    <script src="../jquery-3.7.0.min.js" integrity="sha256-2Pmvv0kuTBOenSvLm6bvfBSSHrUJ+3A7x6P5Ebd07/g="
        crossorigin="anonymous"></script>
    <script src="https://html2canvas.hertzen.com/dist/html2canvas.min.js"></script> <!-- Thêm thư viện html2canvas -->
    <title>Create logo</title>
</head>

<body>
    <span id="head">Tạo logo cho riêng bạn theo phong cách sữa tươi Vinamilk</span>
    <a class="author" target="_blank" href="https://www.facebook.com/toanmn.1309">by Nguyễn Minh Toàn</a>
    <br>
    <div class="contents">
        <input type="text" id="mainI" placeholder="Nội dung chính">
        <input type="text" id="leftI" placeholder="Nội dung bên trái">
        <input type="text" id="rightI" placeholder="Nội dung bên phải">
        <input id="color" class="contents-btn" type="button" onclick="exec()" value="Tạo ảnh">
    </div>
    <button id="downloadBtn" onclick="downloadImage()" disabled>Tải xuống ảnh</button>

    <br>
    <br>
    <div id="logo">
        <label id="main">Tớ Là Rốt</label>
        <br>
        <div id="part">
            <label id="left">Chuyên bán lỗ</label>
            <label id="right">2020</label>
        </div>
    </div>

    <br>
    <br>
    <span id="head">Cho Shốp nào muốn chỉnh logo màu mè nè</span>
    <div class="buttons">
        <input type="color" name="font" id="font" value="#ffffff">
        <input type="color" name="bg" id="bg" value="#0313B0">
        <input type="button" onclick="execColor()" id="color" value="Đổi Màu">
    </div>

    <script>
        function exec() {
            console.log("Code tui làm chơi chơi đừng có copy lung tung nhaaa :3")
            if ($("#mainI").val() == "") {
                alert("Điền nội dung chính vô dùm! (eg. Vinamilk)");
                return;
            }

            if ($("#leftI").val() == "") {
                alert("Điền phần bên trái! (eg. EST)");
                return;
            }

            if ($("#rightI").val() == "") {
                alert("Phần bên phải còn trống kìa! (eg. 1976)");
                return;
            }

            $("#main").html($("#mainI").val());
            $("#left").html($("#leftI").val());
            $("#right").html($("#rightI").val());

            let mw = $("#main").width();

            let losize = mw + 60;
            let dis = (losize - mw) / 2;
            $("#logo").css("width", losize);
            $("#left").css("left", dis);
            $("#right").css("right", dis);

            if (mw > 300) {
                alert("Gõ phần chính hơi dài rồi bạn eiii...!!!");
                return;
            }

            // Kích hoạt nút tải xuống ảnh sau khi tạo ảnh thành công
            document.getElementById("downloadBtn").disabled = false;
        }

        function execColor() {
            $("#logo").css("background-color", $("#bg").val());
            $("#logo").css("color", $("#font").val());
        }

        function downloadImage() {
            html2canvas(document.getElementById("logo")).then(function (canvas) {
                // Chuyển đổi canvas thành đường dẫn URL của ảnh
                let image = canvas.toDataURL("image/png");

                // Tạo một phần tử a để tạo liên kết tải xuống
                let downloadLink = document.createElement("a");
                downloadLink.href = image;
                downloadLink.download = "my_logo.png"; // Đặt tên cho tệp tin ảnh tải xuống

                // Thêm phần tử a vào trang web
                document.body.appendChild(downloadLink);

                // Bấm vào liên kết tải xuống
                downloadLink.click();

                // Xóa phần tử a khỏi trang web
                document.body.removeChild(downloadLink);
            });
        }
    </script>
</body>

</html>